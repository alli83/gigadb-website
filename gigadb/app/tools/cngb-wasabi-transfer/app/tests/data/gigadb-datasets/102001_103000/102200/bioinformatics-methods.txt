1) Nanopore sequencing    Nanopore sequencing 2 micro g of gDNA was repaired using NEB Next FFPE DNA Repair Mix kit (M6630, USA) and subsequently processed using the ONT Template prep kit (SQK-LSK109, UK) according to the manufacturer’s instructions. The large segments library was premixed with loading beads and then pipetted into a previously used and washed R9 flow cell. The library was sequenced on the ONT PromethION platform with Corresponding R9 cell and ONT sequencing reagents kit (EXP-FLP001.PRO.6, UK) according to the manufacturer’s instructions.
De novo genome assembly of nanopore reads    Canu is a comprehensive and scalable pipeline for SMS data assembly (available at https://github.com/marbl/canu, v1.5). In the correction step, Canu first selects longer seed reads with the settings ‘genomeSize=780000000’ and ‘corOutCoverage=50’, SMARTdenovo (default parameters) software was used to assemble the corrected data, and then the next-generation sequencing data were used to conduct three rounds of correction by Racon v1.4.21 (default parameters) and Pilon v1.22 (parameters: --mindepth 10 --changes --threads 4 --fix bases) software. The assembly results were evaluated by the read alignment rate, core gene integrity, and BUSCO evaluation. BWA software was used to align short sequences on the reference genome. The CEGMA v2.5 (default parameters) database and BUSCO v4.0.6 (parameters: odb10, -c 24 -e 1e-3) were used to evaluate the completeness of the assembly.Genome annotation analysis    LTR_FINDER v1.05 (default parameters) and RepeatScout v1.0.5 (default parameters) were used to construct the repetitive sequence database. The database was classified by PASTEClassifier v1.0 (default parameters) and merged with Repbase19.06 (null) as the final repetitive sequence database. RepeatMasker (parameters: -nolow -no_is -norna -engine wublast -qq -frag 20000) software was used to predict the repetitive sequences.     Genscan v3.1, Augustus v2.4, GlimmerHMM v3.0.4, GeneID v1.4 and SNAP (version 2006-07-28) were used for ab initio prediction with default parameters. GeMoMa v1.3.1 (default parameters) was used for homologous species prediction; Hisat v2.0.4 (parameters --max-intronlen 20000, --min-intronlen 20) and Stringtie v1.2.3 (default parameters) were used for assembly based on reference transcripts. TransDecoder v2.0 and GeneMarkS-T v5.1 were used for gene prediction with default parameters. PASA v2.0.2 (parameters: -align_tools gmap, -maxIntronLen 20000) was used to predict unigene sequences based on the assembly data of nonparametric transcriptome. EVM v1.1.1 (default parameters) was used to integrate the prediction results obtained by the above three methods, and PASA v2.0.2 (parameters: -align_tools gmap, -maxIntronLen 20000) was used to modify the prediction results. Rfam v12.1 (parameters: 1e-5) and tRNAscan-SE v1.3.1 (parameters: 1e-5) were used to identify microRNAs and rRNAs, and tRNAs.      The predicted protein sequences were compared with GenBlastA v1.0.4 (parameter: e-value -e 1e-5), and immature stop codons and transcoding mutations in the gene sequences were searched to obtain pseudogenes by GeneWise 2.4.1 (default parameters). The predicted gene sequences were aligned to the NR, KOG, GO, KEGG, TrEMBL functional databases by BLAST v2.2.31 (parameters: -evalue 1e-5), to perform KEGG pathway, KOG functional, GO functional and other gene functional annotation analyses.     

2) Hi-C Assembly    We constructed Hi-C fragment libraries ranging from 300-700 bp insert size as illustrated in Raoet al, and sequenced by sequencing by synthesis (SBS) using the Illumina platform. Briefly, adapter sequences of raw reads were trimmed and low quality PE reads were removed for clean data.     The clean Hi-C reads, were first truncated at the putative Hi-C junctions and then the resulting trimmed reads were aligned to the assembly results with BWA (version 0.7.10-r789, default parameters) software to perform a preassembly for error correction of scaffolds, which required splitting scaffolds into segments of 50?kb on average. Only uniquely alignable read pairs whose mapping quality was greater than 20 were retained for further analysis. Invalid read pairs, including dangling-end and self-cycle, re-ligation and dumped products, were filtered by HiC-Prov2.8.1 (default parameters). The uniquely mapped data were retained to perform assembly with LACHESIS software. Any two segments that showed inconsistent connections with information from the raw scaffold were checked manually. These corrected scaffolds were assembled by LACHESIS. Parameters for running LACHESIS included CLUSTER_MIN_RE_SITES = 5; CLUSTER_MAXLINK_D ENSITY = 2; CLUSTER_ NONINFORMATIVE_RATIO = 2; ORDER_MIN_N_R ES_IN_TRUN = 5; and ORDER_MIN_N_RES_IN_ SHREDS = 5. After this step, placement and orientation errors exhibiting obvious discrete chromatin interaction patterns were manually adjusted.         